---
description: DNS Enumeration Cheat Sheet
---

# DNS Recon

| Domain Name System Enumeration |
| :--- |
| Discover DNS Servers \(TCP Scan\) nmap -p 53 10.20.xx.x/24 |

| Tools |
| :--- |
| nslookup, dig, dnsrecon, sublist3r |

<table>
  <thead>
    <tr>
      <th style="text-align:left">nslookup routine for quick reverse lookup</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">you can one liner this but its useful to have a tool shell as you don&apos;t
        know what you will find</td>
    </tr>
    <tr>
      <td style="text-align:left">
        <p>nslookup</p>
        <p>server 192.168.3.21</p>
        <p>#forward lookup</p>
        <p>xlab.local</p>
        <p>#mx lookup</p>
        <p>set type=mx</p>
        <p>xlab.local</p>
        <p>#reverse lookup</p>
        <p>192.168.2.29</p>
      </td>
    </tr>
  </tbody>
</table>

| DIG |
| :--- |
| DIG = Domain Internet Groper |

| Get IP |
| :--- |
| dig www.blah.com |

| Get IP using another DNS Server \(useful if UPD 53 is open on the target server\) |
| :--- |
| dig -server 8.8.8.8 www. www.blah.com |

| Do a reverse lookup |
| :--- |
| dig @8.8.8.8 -x 8.8.8.8 |

| Show only ip |
| :--- |
| dig  www.blah.com +short |

| Check MX records |
| :--- |
| dig  www.blah.com |

| Check name server records |
| :--- |
| dig  www.blah.com NS |

| Get only TXT records |
| :--- |
| dig blah.comTXT |

| Dig all the things |
| :--- |
| dig  www.blah.com ANY |

| Zone transfer using dig |
| :--- |
| dig @x.x.x.x fakewebsite.xxx -t AXFR +nocookie |

| Zone transfer using host |
| :--- |
| host -t axfr fakewebsite.xxx x.x.x.x |

| Dig and trace the name resolution requests |
| :--- |
| dig +trace fakewebsite.com x.x.x.x |

| SUBDOMAIN ENUMERATION |
| :--- |
| sublist3r -d  www.blah.com -t 3 -e bing |

<table>
  <thead>
    <tr>
      <th style="text-align:left">DNS ENUM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">
        <p></p>
        <p>dnsenum --dnsserver x.x.x.x -enum intranet.fakewebsite.com</p>
        <p>dnsenum --dnsserver x.x.x.x -enum management.fakewebsite.com</p>
        <p>dnsenum --dnsserver x.x.x.x -enum www.fakewebsite.com</p>
      </td>
    </tr>
  </tbody>
</table>

| DNS RECON |
| :--- |
| dnsrecon -d website.com -D /usr/share/wordlists/dnsmap.txt -t std --xml dnsrecon.xml |
| \#lookup website.com using a wordlit using standard type of enum, output to xml filed dnsrecon.xml |
| dnsrecon -d website.com -D /usr/share/wordlists/dnsmap.txt -t std --xml dnsrecon.xml --name\_server 8.8.8.8 |

